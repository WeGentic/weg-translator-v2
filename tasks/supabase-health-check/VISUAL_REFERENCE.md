# Supabase Health Check - Visual Reference Guide

## Component Placement Diagrams

### 1. Login Page Indicator Placement

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    LOGIN PAGE                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                     â”‚
â”‚   [Logo]  Tr-entic                                 â”‚
â”‚           Next-Gen Translation Framework           â”‚
â”‚                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚   â”‚  Login Form                                  â”‚ â”‚
â”‚   â”‚                                              â”‚ â”‚
â”‚   â”‚  Email:    [________________]                â”‚ â”‚
â”‚   â”‚  Password: [________________] [ðŸ‘ï¸]           â”‚ â”‚
â”‚   â”‚  â˜ Remember me    [Forgot password?]        â”‚ â”‚
â”‚   â”‚                                              â”‚ â”‚
â”‚   â”‚  [Sign in] (loading spinner)                â”‚ â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                     â”‚
â”‚   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€    â”‚
â”‚   Create an account for your Organization.         â”‚
â”‚                                                     â”‚
â”‚   [Create a new Account]                           â”‚
â”‚                                                     â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚   â”‚ NEW: ðŸŸ¢ Database connected                  â”‚  â”‚
â”‚   â”‚ or   ðŸ”´ Database unavailable                â”‚  â”‚
â”‚   â”‚ or   â³ Checking connection...               â”‚  â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚   â†‘                                                 â”‚
â”‚   â””â”€â”€ INSERT INDICATOR HERE                        â”‚
â”‚       (Size: Compact, align left)                  â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. Workspace Footer Indicator Placement

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   WORKSPACE                         â”‚
â”‚                 (Main Content)                      â”‚
â”‚                                                     â”‚
â”‚                                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ FOOTER                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  App: 1.0.0  â”‚ ðŸŸ¢ Database connected â”‚  [Logs] [X] â”‚
â”‚              â”‚                        â”‚             â”‚
â”‚  Metrics     â”‚  NEW INDICATOR HERE    â”‚  Actions    â”‚
â”‚              â”‚  (Same size as metrics)â”‚             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   APP INITIALIZATION                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                  â”‚                  â”‚
        â–¼                  â–¼                  â–¼
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚AppEnterâ”‚        â”‚AuthProvider      â”‚useAppHealth
   â”‚        â”‚        â”‚Bootstrap â”‚      â”‚Health Check
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                           â”‚                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”           â”‚
                    â–¼             â–¼           â–¼
             â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
             â”‚Session     â”‚  â”‚AppHealthReport    â”‚
             â”‚State       â”‚  â”‚â”œâ”€ appVersion      â”‚
             â”‚â”œâ”€ user     â”‚  â”‚â”œâ”€ tauriVersion    â”‚
             â”‚â”œâ”€ token    â”‚  â”‚â””â”€ buildProfile    â”‚
             â”‚â””â”€ roles    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ROUTE PROTECTION (__root.tsx)
â”œâ”€â”€ Public: /login, /register
â””â”€â”€ Protected: All others
        â”‚
        â””â”€â”€â–º isAuthenticated? â†’ Route or Redirect

RENDER COMPONENTS
â”œâ”€â”€ LoginRoute
â”‚   â””â”€â”€ ConnectionIndicator (NEW) â† useSupabaseHealth()
â”‚       â””â”€â”€ Supabase Health Check
â”‚           â””â”€â”€ SELECT COUNT(*) FROM accounts LIMIT 1
â”‚
â””â”€â”€ Protected Routes
    â””â”€â”€ WorkspaceFooter
        â””â”€â”€ ConnectionIndicator (NEW) â† useSupabaseHealth()
            â””â”€â”€ Supabase Health Check
```

---

## State Machine: Connection Indicator States

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   INITIAL   â”‚
                    â”‚  (No data)  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
                           â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
                    â”‚   CHECKING  â”‚ â³
                    â”‚ (Loading...)â”‚
                    â””â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”˜
                      â”‚       â”‚
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚                          â”‚
            â–¼ (after 5s timeout)       â–¼ (response)
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚  UNHEALTHY   â”‚          â”‚   SUCCESS   â”‚
      â”‚ ðŸ”´ Database  â”‚          â”‚  (Parse OK) â”‚
      â”‚  unavailable â”‚          â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
            â–²                    â”Œâ”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”
            â”‚                    â”‚  HEALTHY   â”‚
            â”‚                    â”‚ ðŸŸ¢ Databaseâ”‚
            â”‚                    â”‚ connected  â”‚
            â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            â”‚                         â–²
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             (Retry after delay)
```

---

## Component Hierarchy

```
App
â”œâ”€â”€ AppProviders
â”‚   â”œâ”€â”€ AuthProvider
â”‚   â”‚   â””â”€â”€ useAuth() hook
â”‚   â”‚       â””â”€â”€ User auth state
â”‚   â”‚           â”œâ”€â”€ isAuthenticated
â”‚   â”‚           â”œâ”€â”€ user
â”‚   â”‚           â”œâ”€â”€ session
â”‚   â”‚           â””â”€â”€ accountUuid
â”‚   â”‚
â”‚   â”œâ”€â”€ LogProvider
â”‚   â”‚
â”‚   â””â”€â”€ Router (TanStack Router)
â”‚       â”œâ”€â”€ __root.tsx (auth check)
â”‚       â”‚
â”‚       â”œâ”€â”€ /login route
â”‚       â”‚   â””â”€â”€ LoginRoute
â”‚       â”‚       â”œâ”€â”€ LoginForm
â”‚       â”‚       â”‚   â””â”€â”€ useAuth()
â”‚       â”‚       â”‚
â”‚       â”‚       â””â”€â”€ ConnectionIndicator (NEW)
â”‚       â”‚           â””â”€â”€ useSupabaseHealth()
â”‚       â”‚
â”‚       â””â”€â”€ Protected Routes
â”‚           â”œâ”€â”€ MainLayout
â”‚           â”‚   â””â”€â”€ WorkspaceFooter
â”‚           â”‚       â”œâ”€â”€ useLayoutStoreApi()
â”‚           â”‚       â”‚
â”‚           â”‚       â””â”€â”€ ConnectionIndicator (NEW)
â”‚           â”‚           â””â”€â”€ useSupabaseHealth()
â”‚           â”‚
â”‚           â””â”€â”€ [Other features]

Files to Create:
â”œâ”€â”€ /src/core/supabase/queries/health.ts
â”œâ”€â”€ /src/shared/ui/ConnectionIndicator.tsx
â””â”€â”€ /src/app/hooks/useSupabaseHealth.ts

Files to Modify:
â”œâ”€â”€ /src/modules/auth/routes/index.tsx
â””â”€â”€ /src/app/shell/main_elements/footer/WorkspaceFooter.tsx
```

---

## Query Execution Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ useSupabaseHealth() Hook Trigger     â”‚
â”‚ â”œâ”€ Component mounts                  â”‚
â”‚ â””â”€ useEffect dependencies change     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ supabaseHealthCheck() Function        â”‚
â”‚ â”œâ”€ generateCorrelationId()           â”‚
â”‚ â””â”€ Start timer                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Supabase Query Execution             â”‚
â”‚                                      â”‚
â”‚ SELECT COUNT(*) FROM accounts       â”‚
â”‚ LIMIT 1                             â”‚
â”‚                                      â”‚
â”‚ With error mapping:                 â”‚
â”‚ â”œâ”€ Network timeout (5s)             â”‚
â”‚ â”œâ”€ RLS policy violation             â”‚
â”‚ â”œâ”€ Table not found                  â”‚
â”‚ â”œâ”€ Connection refused               â”‚
â”‚ â””â”€ Other DB errors                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
        â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”
        â”‚          â”‚
        â–¼          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ OK   â”‚   â”‚ ERROR  â”‚
    â””â”€â”€â”¬â”€â”€â”€â”˜   â””â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
       â”‚           â”‚
       â–¼           â–¼
   healthy:     error:
   true         mapped
   â”€â”€â”€â”€â”€        â”€â”€â”€â”€â”€â”€
   Return       Return
   {healthy:    {healthy:
    true,        false,
    error:       error:
    null}        msg}
       â”‚           â”‚
       â””â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Update Component State               â”‚
â”‚ â”œâ”€ isHealthy boolean                â”‚
â”‚ â”œâ”€ isLoading boolean                â”‚
â”‚ â””â”€ error string | null              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
             â”‚
             â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Render ConnectionIndicator           â”‚
â”‚                                      â”‚
â”‚ if isLoading:                       â”‚
â”‚   â³ Checking connection...          â”‚
â”‚                                      â”‚
â”‚ else if isHealthy:                  â”‚
â”‚   ðŸŸ¢ Database connected             â”‚
â”‚                                      â”‚
â”‚ else if error:                      â”‚
â”‚   ðŸ”´ Database unavailable           â”‚
â”‚                                      â”‚
â”‚ else:                               â”‚
â”‚   âšª Status unknown                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## File Dependency Graph

```
                    supabaseClient
                    (/src/core/config)
                           â”‚
                           â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ Supabase Auth  â”‚
                   â”‚ Session Mgmt   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚                   â”‚                   â”‚
        â–¼                   â–¼                   â–¼
    AuthProvider    UserQueries        HealthQuery (NEW)
    (Context)       (Queries)          (New File)
        â”‚                   â”‚                   â”‚
        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                   â”‚
        â”‚         â”‚                             â”‚
        â–¼         â–¼                             â–¼
    useAuth()  getUserProfile()      useSupabaseHealth()
                                      (New Hook)
                                         â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚                    â”‚                    â”‚
                    â–¼                    â–¼                    â–¼
            LoginRoute           WorkspaceFooter      Other Components
            (modify)             (modify)
                â”‚                    â”‚
                â–¼                    â–¼
      ConnectionIndicator    ConnectionIndicator
      (New Component)         (Reusable Component)
            â”‚                    â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚
                     â–¼
            Shared UI Elements
            (Badge, Icon, Tooltip)
```

---

## CSS Layout Reference

### Login Page Indicator

```css
/* Container */
.connection-indicator {
  display: flex;
  align-items: center;
  gap: 0.5rem;
  padding: 0.5rem 1rem;
  margin-top: 1rem;
  font-size: 0.875rem;
  border-radius: 0.375rem;
  background-color: rgba(0, 0, 0, 0.05);
}

/* Status Icon */
.connection-indicator__icon {
  width: 1rem;
  height: 1rem;
  animation: pulse 2s infinite;
}

.connection-indicator__icon--healthy {
  color: #22c55e; /* green */
}

.connection-indicator__icon--unhealthy {
  color: #ef4444; /* red */
}

.connection-indicator__icon--checking {
  color: #f59e0b; /* amber */
}

/* Status Text */
.connection-indicator__text {
  font-weight: 500;
  color: #374151;
}

/* Animation */
@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}
```

### Footer Metric

```css
/* Follows existing FooterMetric pattern */
.workspace-footer__metric {
  display: flex;
  flex-direction: column;
  gap: 0.25rem;
  align-items: center;
}

.workspace-footer__metric-label {
  font-size: 0.75rem;
  color: #6b7280;
  text-transform: uppercase;
}

.workspace-footer__metric-value {
  font-size: 0.875rem;
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 0.25rem;
}
```

---

## Timing Diagram

```
Time: 0ms         App mounts
      â”‚
      â”œâ”€â–º useEffect triggers
      â”‚   â”œâ”€â–º setIsLoading(true)
      â”‚   â””â”€â–º Start Supabase query
      â”‚
      â”œâ”€â–º Component renders (loading state shown)
      â”‚   â””â”€â–º UI: â³ Checking connection...
      â”‚
100ms â”œâ”€â–º Still querying...
      â”‚
500ms â”œâ”€â–º Query response received (or timeout approaching)
      â”‚
1000msâ”œâ”€â–º Query completes (or timeout)
      â”‚
      â”œâ”€â–º mapSupabaseError() if needed
      â”œâ”€â–º setIsHealthy() or setError()
      â”œâ”€â–º setIsLoading(false)
      â”‚
      â””â”€â–º Component re-renders with result
          â””â”€â–º UI: ðŸŸ¢ Database connected
              OR ðŸ”´ Database unavailable
              OR âšª Offline

Total time: ~1000-5000ms depending on network
```

---

## Error Scenarios

```
SCENARIO 1: Network Offline
  â”œâ”€ Query times out after 5s
  â”œâ”€ Error: "Connection timeout"
  â”œâ”€ Display: ðŸ”´ Database unavailable
  â””â”€ Action: Show retry button (optional)

SCENARIO 2: RLS Policy Blocks Query
  â”œâ”€ Query succeeds but returns 0 rows
  â”œâ”€ Error: "Permission denied" from Supabase
  â”œâ”€ Display: ðŸ”´ Database unavailable
  â””â”€ Action: Check auth token is valid

SCENARIO 3: Connection Pool Exhausted
  â”œâ”€ Query times out after 5s
  â”œâ”€ Error: "Connection pool exhausted"
  â”œâ”€ Display: ðŸ”´ Database unavailable
  â””â”€ Action: User should retry later

SCENARIO 4: Database Down
  â”œâ”€ Query times out or connection refused
  â”œâ”€ Error: "Connection refused"
  â”œâ”€ Display: ðŸ”´ Database unavailable
  â””â”€ Action: Show "Service unavailable" message

SCENARIO 5: Successful Connection
  â”œâ”€ Query returns COUNT(*) > 0 or = 0
  â”œâ”€ Success: Connection established
  â”œâ”€ Display: ðŸŸ¢ Database connected
  â””â”€ Action: Proceed normally
```

---

## Browser DevTools Inspection Guide

### Check Health Query Results

```javascript
// In Browser Console:

// Get current auth session
const { data } = await supabase.auth.getSession();
console.log('Session:', data);

// Test health query manually
const { data, error } = await supabase
  .from('accounts')
  .select('COUNT(*)', { count: 'exact' })
  .limit(1);

if (error) {
  console.error('Health check failed:', error);
} else {
  console.log('Health check passed:', data);
}
```

### Monitor Hook Execution

```javascript
// React DevTools: Look for useSupabaseHealth() hook state
- isHealthy: boolean
- isLoading: boolean
- error: string | null

// Check re-renders in Profiler
- Mount: Initial data fetch
- Update: When query completes
- Unmount: Cleanup
```

---

## Performance Targets

```
Operation                 Target      Acceptable    Max
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
Health check query       <100ms       <500ms        5000ms
Hook initialization      <50ms        <200ms        1000ms
Component render         <16ms        <50ms         100ms
Indicator display        Instant      <100ms        500ms
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

Budget: Keep total < 500ms to not impact perceived app startup
```

---

## Testing Checklist

```
FUNCTIONAL
âœ“ Indicator appears on login page
âœ“ Indicator appears in footer
âœ“ Shows checking state during query
âœ“ Shows healthy when database is accessible
âœ“ Shows unhealthy when database is unreachable
âœ“ Respects RLS policies
âœ“ Handles query timeout gracefully

EDGE CASES
âœ“ Offline network (query times out)
âœ“ Slow network (query takes >5s)
âœ“ User closes browser during query
âœ“ Component unmounts during query
âœ“ Multiple queries in flight
âœ“ RLS blocks query for unauthenticated user

PERFORMANCE
âœ“ Query completes in <500ms
âœ“ Doesn't block app initialization
âœ“ Doesn't cause layout shift
âœ“ No memory leaks on unmount
âœ“ No infinite loops

UI/UX
âœ“ Styling matches existing components
âœ“ Text is user-friendly (no technical jargon)
âœ“ Responsive on mobile
âœ“ Accessible (ARIA labels, colors)
âœ“ Colors are accessible (contrast ratio)
```

---

